<extend name="Public/base"/>

<block name="style">
    <link rel="stylesheet" href="__CSS__/BeatPicker.min.css"/>
    <link rel="stylesheet" href="__CSS__/newStyle.css"/>
    <style>

    </style>
</block>
<block name="body">
    <!--填写账户信息-->
    <div class="txzhxx">
        <div class="nav">资产日报 &gt; <i class="now">填写账户信息</i></div>
        <div class="step">
            <div class="step1 fontColor">1.日期日报选择</div>
            <div class="step1 step2 border fontColor">2.填写账户信息</div>
            <div class="step1 step2 previewConfirmChrome">3.预览及确认</div>
        </div>
        <form method="post">
            <!--现货账户-->
            <div class="mainContent">
                    <div class="top">现货账户</div>
                    <div class="bottom">
                        <volist name="project_cunhuo" id="item">
                            <h2>{$item['name_project']}&emsp;[{$item['branch_name']}]</h2>
                            <div class="content">
                                <label>资产现金：</label><input type="text" name='asset_money<?php echo ($item["id"]); ?>' ><i>(元)</i>
                                <label class="mL">资产品：</label><input type="text" name='asset_product<?php echo ($item["id"]); ?>'><i>(元)</i>
                                <br/>
                                <label>应&emsp;&emsp;付：</label><input type="text" name='payable<?php echo ($item["id"]); ?>' class="mT"><i>(元)</i>
                                <label class="mL">应&emsp;收：</label><input type="text" name='receivable<?php echo ($item["id"]); ?>'><i>(元)</i>
                                <br/>
                                <label>融资负债/授信：</label><input type="text" name='finance_debt<?php echo ($item["id"]); ?>' class="mT"><i>(元)</i>
                                <br/>
                                <br/>
                                <label>备注：</label><textarea cols="70" rows="5" name='remark<?php echo ($item["id"]); ?>'></textarea>
                            </div>
                        </volist>
                    </div>
                    <div class="leftBar" index="{:count($project_cunhuo)}"></div>
            </div>
            <!--建信期货-->
            <div class="mainContent mT">
                <div class="top" style="background: #f8f8fa">期货账户</div>
                <div class="bottom" style="background: #f8f8fa">
                    <volist name="project_qihuo" id="item">
                        <h2>{$item['name_project']}&emsp;[{$item['branch_name']}]</h2>
                        <div class="content">
                            <label>资产现金：</label><input type="text" name='asset_money<?php echo ($item["id"]); ?>' class="backcolor"><i>(元)</i>
                            <label class="mL">保证金：</label><input type="text" name='asset_product<?php echo ($item["id"]); ?>' class="backcolor"><i>(元)</i>
                            <br/>
                            <label>应&emsp;&emsp;付：</label><input type="text" name='payable<?php echo ($item["id"]); ?>' class="mT backcolor"><i>(元)</i>
                            <label class="mL">应&emsp;收：</label><input type="text" name='receivable<?php echo ($item["id"]); ?>' class="backcolor"><i>(元)</i>
                            <br/>
                            <label>融资负债/授信：</label><input type="text" name='finance_debt<?php echo ($item["id"]); ?>' class="mT backcolor"><i>(元)</i>
                            <br/>
                            <br/>
                            <label>备注：</label><textarea name='remark<?php echo ($item["id"]); ?>' cols="70" rows="5" class="backcolor"></textarea>
                        </div>
                    </volist>
                </div>
                <div class="leftBar" index="{:count($project_qihuo)}"></div>
            </div>
            <!--银行数据-->
            <div class="mainContent mT">
                <div class="top">银行账户</div>
                <div class="bottom">
                    <volist name="project_bank" id="item">
                        <h2>{$item['name_project']}&emsp;[{$item['branch_name']}]</h2>
                        <div class="content">
                            <label>资产现金：</label><input type="text" name='asset_money<?php echo ($item["id"]); ?>'><i>(元)</i>
                            <label class="mL">资产品：</label><input type="text" name='asset_product<?php echo ($item["id"]); ?>'><i>(元)</i>
                            <br/>
                            <label>应&emsp;&emsp;付：</label><input type="text" name='payable<?php echo ($item["id"]); ?>' class="mT"><i>(元)</i>
                            <label class="mL">应&emsp;收：</label><input type="text" name='receivable<?php echo ($item["id"]); ?>'><i>(元)</i>
                            <br/>
                            <label>融资负债/授信：</label><input type="text" name='finance_debt<?php echo ($item["id"]); ?>' class="mT"><i>(元)</i>
                            <br/>
                            <br/>
                            <label>备注：</label><textarea name='remark<?php echo ($item["id"]); ?>' cols="70" rows="5"></textarea>
                        </div>
                    </volist>
                </div>
                <div class="leftBar" index="{:count($project_bank)}"></div>
            </div>
            <input type="submit" value="上一步" class="cancelButton" formaction="{:U('admin/NewReport/dateChoose')}">
            <input type="submit" value="下一步" class="cancelButton nextButton" formaction="{:U('admin/NewReport/nextButtonFAI')}">
        </form>
    </div>

</block>

<block name="script">
    <script><if condition="($Think.request.status neq '') OR ($Think.request.s_time neq '') OR ($Think.request.e_time neq '') ">toggel("reSearchM");<else />toggel("RCsearch");</if></script>
    <script src="__JS__/BeatPicker.min.js"></script>
    <script src="__JS__/changeDate.js"></script>
    <script type="text/javascript">
        $(function(){
            //点击输入框，变色
            $("input[type='text']").on('focus',function(){
               $(this).css('border','2px solid #8adef1')
            }).on('focusout',function(){
                $(this).css('border','2px solid #dfdfe0')
            })
            //点击textarea变色
            $("textarea").on('focus',function(){
                $(this).css('border','2px solid #8adef1')
            }).on('focusout',function(){
                $(this).css('border','2px solid #dfdfe0')
            })
            //控制左边边框的颜色，高度
            $(".leftBar").each(function(index,value){
                var number = $(value).attr('index');
                var height = 90 + 220*number + (number-1)*50
                $(value).css('height',height)
                switch (index){
                    case 0:
                        $(value).css('background',"#e36f64")
                        break;
                    case 1:
                        $(value).css('background',"#8ccd5a")
                        break;
                    case 2:
                        $(value).css('background',"#01b6e1")
                        break;
                }
            })
            //如果是业务操作员，不能输入银行数据
            if("{:session('admin')['power']}" == 1){
                $(".mainContent:eq(2)").remove()
            }
//            if("{:session('admin')['power']}" == 1){
//                $(".mainContent:eq(2) input[type='text']").each(function(index,value){
//                    //输入框变为灰色，不可输入，移除focus,移除name属性
//                    $(value).attr("readonly",true).css('background','#f3f3f5').off('focus').attr('onfocus','this.blur()').removeAttr('name')
//                })
//
//                $(".mainContent:eq(2) textarea").each(function(index,value){
//                    //输入框变为灰色，不可输入，移除focus,移除name属性
//                    $(value).attr("readonly",true).css('background','#f3f3f5').off('focus').attr('onfocus','this.blur()').removeAttr('name')
//                })
//            }
            //如果是银行人员操作，把现货账户，期货账户两个div删除了
            if("{:session('admin')['power']}" == 2){
                $(".mainContent:lt(2)").remove()
            }
            //检查输入的数据是否符合要求
            $("input[type='text']").each(function(index,value){
                $(value).on('keyup',function(){
                    if(!(value.value == '-')){
                        if (isNaN(value.value)) {
                            value.value = "";
                        }
                    }
                    if (value != null) {
                        //检查小数点后是否对于两位http://blog.csdn.net/shanzhizi
                        if (value.value.toString().split(".").length > 1 && value.value.toString().split(".")[1].length > 4) {
                            alert("小数点后多于四位！");
                            value.value = "";
                        }
                    }
                })
            })

        })

    </script>
</block>